<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Formulaire de vente</title>
</head>
<body>
    <h1>Formulaire de vente</h1>

		<form th:action="@{/vente}" th:object="${commande}" method="post" id="formCommande">
	    <label for="dateCommande">Date de commande:</label>
	    <input type="date" id="dateCommande" th:field="*{dateCommande}" name="dateCommande" required><br><br>
	
	    <label for="client">Client:</label>
	    <select id="client" th:field="*{client.code}" name="client.code" required>
	        <option value="">Sélectionner un client</option>
	        <!-- Utilisation de th:each pour afficher les clients -->
	        <option th:each="client : ${clients}" th:value="${client.code}" th:text="${client.nom}"></option>
	    </select><br><br>
	    <input type="submit" value="Enregistrer">
	</form>

    <form th:action="@{/ligneCommande/ajouter}" th:object="${ligneCommande}" method="post" id="formLigneCommande">
    <input type="hidden" id="numeroCommande" name="numero" th:value="${commande.numero}">
           
    <label for="produit">Produit:</label>
    <select id="produit" th:field="*{produit.ref}" name="produit.ref" required>
        <option value="">Sélectionner un produit</option>
        <!-- Utilisation de th:each pour afficher les produits -->
        <option th:each="produit : ${produits}" th:value="${produit.ref}" th:text="${produit.designation}" th:attr="data-prix=${produit.prix}"></option>
    </select><br><br>
    <input type="text" id="prixProduit" readonly>
    <script>
document.getElementById("produit").addEventListener("change", function() {
    var selectedProduct = this.options[this.selectedIndex];
    var prixProduit = document.getElementById("prixProduit");
    prixProduit.value = selectedProduct.getAttribute("data-prix");
});
</script>

    <label for="qte">Quantité:</label>
    <input type="number" id="qte" th:field="*{qte}" name="qte" required><br><br>
    <button type="button" id="btnMultiplication">Multiplier</button>
    <script>
document.getElementById("btnMultiplication").addEventListener("click", function() {
    var prixProduit = parseFloat(document.getElementById("produit").options[document.getElementById("produit").selectedIndex].getAttribute("data-prix"));
    var quantite = parseInt(document.getElementById("qte").value);
    var resultat = prixProduit * quantite;
    document.getElementById("resultat").value = resultat.toFixed(2); // Formater le résultat avec deux décimales
});
</script>
    

<label for="resultat">Résultat:</label>
<input type="text" id="resultat" th:field="*{total}" readonly>

    <input type="submit" value="Ajouter">
</form>

    

</body>
</html>